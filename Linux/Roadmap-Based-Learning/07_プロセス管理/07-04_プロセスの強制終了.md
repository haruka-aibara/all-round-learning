# 【Linux講座】プロセスの強制終了

## 概要と重要性
Linuxシステムでは常に多くのプロセスが実行されており、システムのバグや予期せぬ動作により、プロセスを強制的に終了させる必要が生じることがあります。

## 主要概念
Linuxの`kill`コマンドは、特定のシグナルをプロセスに送信することでプロセスを停止、一時停止、または終了させるための組み込みコマンドです。

## 実際に試せるコマンド例

### 1. 実行中のプロセスを確認する

まず、システム上で実行中のプロセスを確認してみましょう。以下のコマンドを入力して実行してみましょう：

```bash
ps aux
```

実行結果：
```
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.5 225868  5288 ?        Ss   10:59   0:06 /sbin/init
root         2  0.0  0.0      0     0 ?        S    10:59   0:00 [kthreadd]
...
username  1234  0.2  1.5 545676 15724 pts/0    Sl   11:15   0:02 firefox
...
```

このコマンドは、現在実行中のすべてのプロセスとそのプロセスID（PID）を表示します。PIDは、プロセスを終了させる際に必要になります。

### 2. 特定のプロセスを検索する

特定のプロセス（例：firefox）を検索するには、以下のコマンドを入力して実行してみましょう：

```bash
pgrep firefox
```

または：

```bash
ps aux | grep firefox
```

実行結果：
```
1234
```

または：

```
username  1234  0.2  1.5 545676 15724 pts/0    Sl   11:15   0:02 firefox
username  1456  0.0  0.1  14224  1024 pts/0    S+   11:20   0:00 grep --color=auto firefox
```

これらのコマンドで、特定のプロセス（この例ではfirefox）のPIDを見つけることができます。

### 3. プロセスを通常終了させる

特定のプロセスを通常終了させるには、以下のコマンドを入力して実行してみましょう：

```bash
kill 1234
```

このコマンドは、PID 1234（この例ではfirefox）に対してSIGTERM（15）シグナルを送信します。これは、プロセスに「正常に終了してください」と要求するシグナルです。プロセスは終了処理を行った後に終了します。

通常は画面上に特に出力はありませんが、プロセスが終了したことを確認するために、再度プロセスを検索してみましょう：

```bash
ps aux | grep firefox
```

### 4. プロセスを強制終了させる

プロセスが応答しない場合は、強制終了させる必要があります。以下のコマンドを入力して実行してみましょう：

```bash
kill -9 1234
```

または：

```bash
kill -SIGKILL 1234
```

このコマンドは、PID 1234のプロセスにSIGKILL（9）シグナルを送信します。これは、プロセスを即座に強制終了させるシグナルです。プロセスは終了処理を行わずに終了します。

### 5. プロセス名で終了させる

プロセス名を指定して終了させるには、`pkill`コマンドを使用します。以下のコマンドを入力して実行してみましょう：

```bash
pkill firefox
```

このコマンドは、名前に「firefox」を含むすべてのプロセスにSIGTERMシグナルを送信します。

### 6. より強力な`killall`コマンド

特定の名前を持つすべてのプロセスを終了させるには、`killall`コマンドも使用できます。以下のコマンドを入力して実行してみましょう：

```bash
killall firefox
```

このコマンドは、名前が完全に「firefox」と一致するすべてのプロセスにSIGTERMシグナルを送信します。

強制終了させるには：

```bash
killall -9 firefox
```

### 7. シグナルの種類を確認する

Linuxで使用できるシグナルの種類を確認するには、以下のコマンドを入力して実行してみましょう：

```bash
kill -l
```

実行結果：
```
 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP
 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1
11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM
...
```

主要なシグナル：
- SIGTERM (15): デフォルトのシグナル。プロセスに正常終了を要求します。
- SIGKILL (9): プロセスを即座に強制終了させます。
- SIGHUP (1): プロセスに設定の再読み込みを要求します。
- SIGINT (2): キーボードからの割り込み（Ctrl+C）に相当します。

### 8. より詳細なプロセス情報を表示する

特定のプロセスの詳細情報を表示するには、以下のコマンドを入力して実行してみましょう：

```bash
ps -p 1234 -f
```

実行結果：
```
UID        PID  PPID  C STIME TTY          TIME CMD
username  1234  1200  0 11:15 pts/0    00:00:02 firefox
```

このコマンドは、指定したPID（この例では1234）のプロセスの詳細情報を表示します。

### 9. プロセスのツリー構造を表示する

プロセスの親子関係を確認するには、以下のコマンドを入力して実行してみましょう：

```bash
pstree
```

または特定のプロセスのツリーを表示する場合：

```bash
pstree -p 1234
```

このコマンドは、プロセスのツリー構造を表示します。親プロセスとその子プロセスの関係を視覚的に確認できます。
