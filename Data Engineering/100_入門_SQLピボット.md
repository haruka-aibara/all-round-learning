# SQLピボット (難易度レベル: 100)

## 概要
SQLピボットは、行データを列データに変換する操作です。データベースから取得した結果を、より見やすく分析しやすい形式に整形する際に使用されます。例えば、月別の売上データを横並びの表形式に変換することで、トレンド分析が容易になります。

## 詳細

### ピボットとは
ピボット（PIVOT）は、行と列を入れ替える操作のことです。データベースでは、通常データは行として格納されていますが、分析やレポート作成時には列として表示したい場合があります。

### 基本的な考え方
- **行データ**: 縦に並んだデータ（例：月別売上）
- **列データ**: 横に並んだデータ（例：月を列として表示）
- **ピボット**: 行→列への変換

### 使用シーン
- 月別・年別の売上レポート
- 商品別の売上分析
- 地域別のデータ比較
- 時系列データの可視化

### 実践的な活用方法
1. **データの準備**: ピボットしたいデータを特定
2. **変換軸の決定**: どの行を列に変換するか決める
3. **集計方法の選択**: 合計、平均、最大値など
4. **結果の確認**: 変換後のデータが意図通りかチェック

## 具体例

### 基本的な使用例
商品の月別売上データがあるとします：

**元のデータ（行形式）:**
```
商品名    月    売上
りんご    1月   100
りんご    2月   150
りんご    3月   120
みかん    1月   80
みかん    2月   90
みかん    3月   110
```

**ピボット後（列形式）:**
```
商品名    1月   2月   3月
りんご    100  150  120
みかん    80   90   110
```

### 実装例（SQL Server）
```sql
-- 基本的なピボットクエリ
SELECT 商品名, [1月], [2月], [3月]
FROM (
    SELECT 商品名, 月, 売上
    FROM 売上テーブル
) AS 元データ
PIVOT (
    SUM(売上)
    FOR 月 IN ([1月], [2月], [3月])
) AS ピボット結果;
```

### 注意点やベストプラクティス
- **列名の指定**: ピボット後の列名は事前に決めておく
- **NULL値の処理**: データがない場合の表示方法を考慮
- **パフォーマンス**: 大量データの場合は処理時間に注意
- **データの整合性**: 元データの正確性を確認

## まとめ

### 学んだことの振り返り
- SQLピボットは行データを列データに変換する操作
- データ分析やレポート作成で活用される
- 基本的な構文と使用シーンを理解
- 具体的な例を通じて実践的な使い方を学習

### 次のステップへの提案
1. **実際のデータで練習**: 自分のデータベースでピボットを試してみる
2. **条件付きピボット**: WHERE句を使った条件付きピボットの学習
3. **動的ピボット**: 列数が可変の場合の対処法
4. **他のデータベース**: MySQL、PostgreSQLなどでのピボット実装
5. **UNPIVOT**: 列から行への逆変換操作の学習

SQLピボットは、データ分析の基本スキルとして非常に重要です。この基礎をしっかり理解することで、より高度なデータ操作や分析が可能になります。 
