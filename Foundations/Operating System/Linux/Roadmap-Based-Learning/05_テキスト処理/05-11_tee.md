# 【Linux講座】teeコマンド

## 概要
teeコマンドはLinuxでのテキスト処理において、標準入力からのデータを画面に出力しながら同時にファイルにも保存できる便利なユーティリティです。

## 主要概念
teeコマンドはその名前が示すようにT字型の配管のように、入力を二方向（標準出力とファイル）に分岐させる機能を持ちます。

## 実践コマンド例

### 1. teeの基本的な使い方

以下のコマンドを入力して実行してみましょう：

```bash
echo "これはテストです" | tee test_file.txt
```

期待される出力：
```
これはテストです
```

**解説**：
このコマンドは「これはテストです」というテキストを標準出力（画面）に表示すると同時に、「test_file.txt」というファイルにも書き込みます。echoコマンドの出力をパイプ（|）でteeコマンドに渡しています。

内容を確認してみましょう：

```bash
cat test_file.txt
```

期待される出力：
```
これはテストです
```

### 2. 複数のファイルに同時に書き込む

以下のコマンドを入力して実行してみましょう：

```bash
echo "複数ファイルに書き込みます" | tee file1.txt file2.txt
```

期待される出力：
```
複数ファイルに書き込みます
```

**解説**：
このコマンドは同じ内容を複数のファイル（file1.txtとfile2.txt）に同時に書き込みます。作業結果を複数の場所に記録したい場合に便利です。

それぞれのファイルの内容を確認してみましょう：

```bash
cat file1.txt
cat file2.txt
```

両方のファイルに「複数ファイルに書き込みます」と表示されるはずです。

### 3. ファイルに追記する

以下のコマンドを入力して実行してみましょう：

```bash
echo "これは1行目です" > append_file.txt
echo "これは追記される2行目です" | tee -a append_file.txt
```

期待される出力（2行目のコマンドの出力）：
```
これは追記される2行目です
```

**解説**：
`-a`オプションを使うことで、既存のファイルに上書きではなく追記（append）できます。このオプションがないと、ファイルの内容は上書きされてしまいます。

内容を確認してみましょう：

```bash
cat append_file.txt
```

期待される出力：
```
これは1行目です
これは追記される2行目です
```

### 4. コマンドの出力をログに記録しながら処理する

以下のコマンドを入力して実行してみましょう：

```bash
ls -l | tee command_log.txt | grep "txt"
```

**解説**：
このコマンドは、`ls -l`の出力を「command_log.txt」に保存しながら、同時に`grep`コマンドで「txt」を含む行だけをフィルタリングして表示します。これにより、コマンドの完全な出力をログに残しながら、必要な情報だけを画面に表示できます。

例えば、先ほど作成したテキストファイルの一覧が表示されるはずです。

内容を確認してみましょう：

```bash
cat command_log.txt
```

期待される出力：
カレントディレクトリの全ファイル一覧（`ls -l`の完全な出力結果）が表示されます。

### 5. 標準エラー出力も含めて記録する

以下のコマンドを入力して実行してみましょう：

```bash
ls -l existing_file.txt non_existent_file.txt 2>&1 | tee error_log.txt
```

**解説**：
このコマンドは、標準出力と標準エラー出力（2>&1でマージ）の両方をteeに渡し、「error_log.txt」に記録します。存在しないファイル「non_existent_file.txt」へのアクセスエラーも記録されます。

内容を確認してみましょう：

```bash
cat error_log.txt
```

期待される出力：
「existing_file.txt」の情報（もし存在する場合）と「non_existent_file.txt: No such file or directory」というエラーメッセージが表示されるはずです。

### 6. 大量のデータを処理しながらファイルに保存する

以下のコマンドを入力して実行してみましょう：

```bash
cat /etc/passwd | tee passwd_backup.txt | wc -l
```

期待される出力：
システム上のユーザーアカウント数（行数）が表示されます。

**解説**：
このコマンドは、システムユーザー情報（/etc/passwd）をファイル「passwd_backup.txt」にコピーしながら、同時に行数を数えて表示します。大量のデータを処理する際に、中間結果をファイルに保存しながら別の処理を行うことができます。

内容を確認してみましょう：

```bash
head passwd_backup.txt
```

期待される出力：
「passwd_backup.txt」ファイルの最初の10行が表示されます。

以上で、teeコマンドの基本的な使い方を学習しました。このコマンドはシェルスクリプト作成やシステム管理作業において、処理結果のログ取りに非常に便利です。
