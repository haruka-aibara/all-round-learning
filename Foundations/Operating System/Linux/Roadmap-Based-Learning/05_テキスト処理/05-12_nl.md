Let me create a Linux tutorial on the "nl" command for line numbering.

# 【Linux講座】nl コマンド

## 概要
「nl」コマンドはテキストファイルの行に番号を付けるためのLinuxユーティリティで、ファイル内の特定の位置を把握するのに役立ちます。

## 主要概念
nlコマンドはデフォルトで空でない行にのみ番号を付けますが、様々なオプションでこの動作をカスタマイズできます。

## 実践コマンド例

### 1. 基本的な行番号付け

まずはテスト用のファイルを作成しましょう：

```bash
cat > sample.txt << EOF
これは最初の行です。
これは2行目です。

これは4行目です。
これは5行目です。
EOF
```

このコマンドを入力して実行してみましょう。「sample.txt」というファイルが作成されます。

次に、基本的なnlコマンドを実行します：

```bash
nl sample.txt
```

このコマンドを入力して実行してみましょう。出力例：

```
     1	これは最初の行です。
     2	これは2行目です。

     3	これは4行目です。
     4	これは5行目です。
```

**解説**：
デフォルトでは、nlコマンドは空でない行にのみ行番号を付けます。注目すべき点として、空行（3行目）には番号が付いていないため、「これは4行目です。」は実際には3番目の行番号を受け取っています。

### 2. すべての行に番号を付ける

空行も含めてすべての行に番号を付けるには、`-ba`オプションを使用します：

```bash
nl -ba sample.txt
```

このコマンドを入力して実行してみましょう。出力例：

```
     1	これは最初の行です。
     2	これは2行目です。
     3	
     4	これは4行目です。
     5	これは5行目です。
```

**解説**：
`-ba`オプション（body-all）を使用すると、空行を含むすべての行に番号が付きます。これにより、「これは4行目です。」は正確に4番目の行番号を受け取ります。

### 3. 行番号の書式を変更する

行番号の書式を変更するには、`-n`オプションを使用します：

```bash
nl -n rn sample.txt
```

このコマンドを入力して実行してみましょう。出力例：

```
1     	これは最初の行です。
2     	これは2行目です。

3     	これは4行目です。
4     	これは5行目です。
```

**解説**：
`-n rn`オプションは「right justified, no leading zeros」を意味し、行番号を右揃えで、先頭にゼロを付けずに表示します。他の形式として以下があります：
- `ln`: 左揃え
- `rz`: 右揃えでゼロ詰め

### 4. 行番号と本文の区切り文字を変更する

区切り文字を変更するには、`-s`オプションを使用します：

```bash
nl -s '. ' sample.txt
```

このコマンドを入力して実行してみましょう。出力例：

```
     1. これは最初の行です。
     2. これは2行目です。

     3. これは4行目です。
     4. これは5行目です。
```

**解説**：
`-s`オプションはセパレータを指定します。デフォルトはタブ（`\t`）ですが、ここではピリオドとスペース（`. `）に変更しています。

### 5. 行番号の幅を変更する

行番号の幅を変更するには、`-w`オプションを使用します：

```bash
nl -w 3 sample.txt
```

このコマンドを入力して実行してみましょう。出力例：

```
  1	これは最初の行です。
  2	これは2行目です。

  3	これは4行目です。
  4	これは5行目です。
```

**解説**：
`-w 3`オプションは行番号の幅を3文字に設定します。デフォルトは6文字幅です。

### 6. 行番号の開始値を指定する

行番号の開始値を変更するには、`-v`オプションを使用します：

```bash
nl -v 10 sample.txt
```

このコマンドを入力して実行してみましょう。出力例：

```
    10	これは最初の行です。
    11	これは2行目です。

    12	これは4行目です。
    13	これは5行目です。
```

**解説**：
`-v 10`オプションを使うと、行番号が10から始まります。これはコードのスニペットやページの一部を表示する際に便利です。

### 7. 特定のパターンで番号付けをリセットする

ファイル内の特定のパターンで行番号をリセットするには：

```bash
cat > sections.txt << EOF
SECTION 1
項目1-1
項目1-2
SECTION 2
項目2-1
項目2-2
EOF

nl -p -b p'^SECTION' -n rn sections.txt
```

これらのコマンドを順に入力して実行してみましょう。出力例：

```
1     	SECTION 1
1     	項目1-1
2     	項目1-2
1     	SECTION 2
1     	項目2-1
2     	項目2-2
```

**解説**：
`-p`オプションは番号付けをリセットするモードを有効にし、`-b p'^SECTION'`は「SECTION」で始まる行を本文の区切りとして扱い、その後の行番号をリセットします。

### 8. 複数ファイルに行番号を付ける

```bash
cat > second.txt << EOF
別のファイルの1行目
別のファイルの2行目
EOF

nl sample.txt second.txt
```

これらのコマンドを順に入力して実行してみましょう。出力例：

```
     1	これは最初の行です。
     2	これは2行目です。

     3	これは4行目です。
     4	これは5行目です。
     1	別のファイルの1行目
     2	別のファイルの2行目
```

**解説**：
複数のファイルを指定すると、nlコマンドは各ファイルに対して行番号を付けます。新しいファイルが始まると行番号はリセットされています。

### 9. 行番号を連続させて複数ファイルに付ける

行番号をリセットせずに連続して付けるには：

```bash
cat sample.txt second.txt | nl
```

このコマンドを入力して実行してみましょう。出力例：

```
     1	これは最初の行です。
     2	これは2行目です。

     3	これは4行目です。
     4	これは5行目です。
     5	別のファイルの1行目
     6	別のファイルの2行目
```

**解説**：
パイプを使用して複数ファイルの内容を結合し、それをnlコマンドに渡すことで、連続した行番号付けを実現できます。

以上がnlコマンドの基本的な使い方です。これらのオプションを組み合わせることで、様々な形式でテキストファイルに行番号を付けることができます。
