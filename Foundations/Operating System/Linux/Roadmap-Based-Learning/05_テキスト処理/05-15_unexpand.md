# 【Linux講座】unexpandコマンド

## 概要
Linuxにおけるunexpandコマンドは、空白文字をタブに変換するためのテキスト処理ツールで、特にプログラミングにおいて一貫したインデントを維持するのに役立ちます。

## 主要概念
unexpandはexpandコマンドの逆の動作を行い、指定した数の連続した空白文字をタブ文字に置き換えることで、テキストファイルのフォーマットを調整します。

## 実践コマンド例

### 1. 基本的なunexpandの使用方法

まず、テスト用のファイルを作成しましょう。

```bash
echo "    これは4つの空白でインデントされた文です。" > spaces.txt
echo "        これは8つの空白でインデントされた文です。" >> spaces.txt
```

このコマンドを入力して実行してみましょう。「spaces.txt」というファイルが作成され、それぞれの行が空白でインデントされた内容が書き込まれます。

次に、ファイルの内容を確認します。

```bash
cat spaces.txt
```

このコマンドを入力して実行してみましょう。以下のような出力が表示されるはずです：

```
    これは4つの空白でインデントされた文です。
        これは8つの空白でインデントされた文です。
```

では、unexpandコマンドを使用して、ファイル内の空白をタブに変換してみましょう。

```bash
unexpand spaces.txt > tabs.txt
```

このコマンドを入力して実行してみましょう。unexpandはデフォルトで8つの空白を1つのタブに変換します。結果は「tabs.txt」という新しいファイルに出力されます。

変換されたファイルを確認してみましょう。

```bash
cat -A tabs.txt
```

このコマンドを入力して実行してみましょう。「-A」オプションは非表示文字（タブや改行など）を表示します。以下のような出力が表示されるはずです：

```
^Iこれは4つの空白でインデントされた文です。$
^I    これは8つの空白でインデントされた文です。$
```

出力では、「^I」がタブ文字を表しています。最初の行では4つの空白が1つのタブに変換され、2行目では8つの空白が1つのタブになり、残りの4つの空白はそのまま表示されています。

### 2. タブサイズを指定してunexpandを使用

デフォルトでは、unexpandは8つの空白を1つのタブとして変換しますが、「-t」オプションを使って変換する空白の数を指定できます。

```bash
unexpand -t 4 spaces.txt > tabs4.txt
```

このコマンドを入力して実行してみましょう。「-t 4」オプションにより、4つの空白を1つのタブに変換します。

変換されたファイルを確認してみましょう。

```bash
cat -A tabs4.txt
```

このコマンドを入力して実行してみましょう。以下のような出力が表示されるはずです：

```
^Iこれは4つの空白でインデントされた文です。$
^I^Iこれは8つの空白でインデントされた文です。$
```

今度は、最初の行では4つの空白が1つのタブに、2行目では8つの空白が2つのタブに変換されています。

### 3. 先頭の空白のみを変換する

デフォルトでは、unexpandはファイル内のすべての空白シーケンスを変換しますが、「--first-only」オプションを使うと行頭の空白のみを変換できます。

まず、テキスト内に空白が含まれるファイルを作成しましょう。

```bash
echo "    これは先頭に空白がある文です。文中    にも空白があります。" > mixed_spaces.txt
```

このコマンドを入力して実行してみましょう。

次に、先頭の空白のみを変換してみましょう。

```bash
unexpand --first-only mixed_spaces.txt > first_only_tabs.txt
```

このコマンドを入力して実行してみましょう。「--first-only」オプションにより、行頭の空白シーケンスのみがタブに変換されます。

変換されたファイルを確認してみましょう。

```bash
cat -A first_only_tabs.txt
```

このコマンドを入力して実行してみましょう。以下のような出力が表示されるはずです：

```
^Iこれは先頭に空白がある文です。文中    にも空白があります。$
```

行頭の空白はタブに変換されましたが、「文中」と「にも」の間の空白はそのまま残っていることがわかります。

### 4. パイプを使ったunexpandの活用

unexpandはパイプラインでも使用できます。例えば、別のコマンドの出力結果の空白をタブに変換することができます。

```bash
cat spaces.txt | unexpand -t 2 > piped_tabs.txt
```

このコマンドを入力して実行してみましょう。「cat spaces.txt」の出力が「unexpand -t 2」に渡され、2つの空白ごとにタブに変換されます。

変換されたファイルを確認してみましょう。

```bash
cat -A piped_tabs.txt
```

このコマンドを入力して実行してみましょう。空白が2つごとにタブに変換されていることを確認できます。

以上がLinuxのunexpandコマンドの基本的な使い方です。このコマンドを活用することで、テキストファイルのフォーマットを効率的に調整できます。特にプログラミングの際には、一貫したインデントスタイルを維持するのに役立ちます。
