# 【Linux講座】リダイレクト

## 概要
リダイレクトとは、コマンドの入出力の流れを変更する機能で、Linuxシェルでの作業効率を大幅に向上させます。

## 基本概念
Linuxでは、標準入力(stdin)、標準出力(stdout)、標準エラー出力(stderr)の3つの標準ストリームを操作・制御することができます。

## 実践コマンド例

### 1. 標準出力(stdout)のリダイレクト

**コマンド例1: 標準出力を新しいファイルに書き込む**

このコマンドを入力して実行してみましょう：
```bash
ls -l > file_list.txt
```

このコマンドは、`ls -l`コマンドの結果（カレントディレクトリのファイル一覧）をターミナルに表示せず、`file_list.txt`というファイルに書き込みます。ファイルが存在しない場合は新規作成され、既に存在する場合は上書きされます。

実行結果を確認するには：
```bash
cat file_list.txt
```

実行すると、先ほど`ls -l`で得られるはずだった出力が表示されます。

**コマンド例2: 標準出力を既存ファイルに追記する**

このコマンドを入力して実行してみましょう：
```bash
echo "新しい行を追加します" >> file_list.txt
```

`>>`は追記モードで、既存ファイルの末尾に新しい内容を追加します。

実行結果を確認するには：
```bash
cat file_list.txt
```

ファイルの最後に「新しい行を追加します」という文字列が追加されているはずです。

### 2. 標準エラー出力(stderr)のリダイレクト

**コマンド例3: エラー出力をファイルにリダイレクトする**

このコマンドを入力して実行してみましょう：
```bash
ls -l /存在しないディレクトリ 2> error.txt
```

`2>`は標準エラー出力（ファイルディスクリプタ2）をリダイレクトします。存在しないディレクトリを指定しているので、エラーメッセージが`error.txt`に書き込まれます。

実行結果を確認するには：
```bash
cat error.txt
```

「そのようなファイルやディレクトリはありません」といったエラーメッセージが表示されます。

### 3. 標準出力と標準エラー出力を同時にリダイレクト

**コマンド例4: 出力とエラーを別々のファイルに保存**

このコマンドを入力して実行してみましょう：
```bash
ls -l /etc /存在しないディレクトリ > output.txt 2> error.txt
```

これにより、正常な出力（/etcディレクトリの内容）は`output.txt`に、エラーメッセージは`error.txt`に保存されます。

実行結果を確認するには：
```bash
cat output.txt
cat error.txt
```

**コマンド例5: 出力とエラーを同じファイルに保存**

このコマンドを入力して実行してみましょう：
```bash
ls -l /etc /存在しないディレクトリ > all_output.txt 2>&1
```

`2>&1`は「標準エラー出力を標準出力と同じ場所に送る」という意味です。これにより、両方の出力が`all_output.txt`に保存されます。

Bash 4以降では、より簡潔な記法も使えます：
```bash
ls -l /etc /存在しないディレクトリ &> all_output.txt
```

実行結果を確認するには：
```bash
cat all_output.txt
```

### 4. 標準入力(stdin)のリダイレクト

**コマンド例6: ファイルの内容をコマンドの入力として使用**

このコマンドを入力して実行してみましょう：
```bash
sort < file_list.txt
```

これは`file_list.txt`の内容を`sort`コマンドの入力として使用し、アルファベット順に並べ替えます。

### 5. /dev/null へのリダイレクト

**コマンド例7: 出力を破棄する**

このコマンドを入力して実行してみましょう：
```bash
ls -l > /dev/null
```

`/dev/null`は特殊なデバイスファイルで、ここにリダイレクトされたすべての出力は完全に破棄されます。コマンドの実行結果が不要な場合に使用します。

### 6. ヒアドキュメント（Here Document）

**コマンド例8: 複数行の入力をコマンドに渡す**

このコマンドを入力して実行してみましょう：
```bash
cat << EOF > multiline.txt
これは1行目です。
これは2行目です。
これは3行目です。
EOF
```

この構文（`<<`）はヒアドキュメントと呼ばれ、複数行のテキストをコマンドの入力として渡せます。`EOF`までのすべての行が`cat`コマンドの入力となり、`multiline.txt`に保存されます。

実行結果を確認するには：
```bash
cat multiline.txt
```

### 7. パイプとリダイレクトの組み合わせ

**コマンド例9: パイプとリダイレクトを組み合わせる**

このコマンドを入力して実行してみましょう：
```bash
ls -l | grep "Apr" > april_files.txt
```

これは`ls -l`の出力を`grep`コマンドに渡し、「Apr」を含む行（4月に変更されたファイル）だけを抽出して`april_files.txt`に保存します。

実行結果を確認するには：
```bash
cat april_files.txt
```

以上がLinuxにおけるリダイレクトの基本的な使い方です。これらのコマンドを使いこなせば、コマンドラインでの作業効率が大幅に向上します。
