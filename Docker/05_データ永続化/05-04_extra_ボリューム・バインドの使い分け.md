# Dockerのボリュームマウントとバインドマウントの使い分け

## 概要
Dockerにおけるデータ永続化の手法であるボリュームマウントとバインドマウントの適切な使い分けは、コンテナ運用の信頼性と効率性に直結します。

## 主要概念
ボリュームマウントはDockerが管理するストレージ空間を利用し、バインドマウントはホストマシン上の特定ディレクトリを直接マウントする方式です。

## 1. ボリュームマウント

### 特徴
- Dockerエンジンによって管理される専用のストレージ領域を使用
- ホストOSのファイルシステムから独立している
- Dockerコマンドで作成・管理が可能

### 使用例
```bash
# ボリュームの作成
docker volume create my_volume

# ボリュームを使用してコンテナを起動
docker run -v my_volume:/app/data nginx
```

### 最適な使用シーン
- データの永続化が必要な場合（DBデータなど）
- ホストマシンのファイルシステム構造に依存したくない場合
- コンテナ間でデータを共有する場合
- 自動バックアップや移行が必要な場合

## 2. バインドマウント

### 特徴
- ホストマシン上の特定のディレクトリをコンテナ内にマウント
- ホストとコンテナでファイルを直接共有できる
- ホスト側でのファイル変更がリアルタイムでコンテナに反映される

### 使用例
```bash
# ホストの現在のディレクトリをコンテナの/app/dataにマウント
docker run -v $(pwd):/app/data nginx
```

### 最適な使用シーン
- 開発中のソースコードをコンテナ内で実行する場合
- 設定ファイルをホスト側から提供する場合
- ログファイルをホスト側で直接確認したい場合
- 既存のディレクトリ構造を活用したい場合

## 3. 両者の比較

| 項目 | ボリュームマウント | バインドマウント |
|------|-----------------|-----------------|
| 管理者 | Dockerエンジン | ホストOS |
| 場所 | `/var/lib/docker/volumes/` など | ホスト上の任意のパス |
| 移植性 | 高い | 低い（ホスト依存） |
| バックアップ | Docker管理ツールで対応可能 | ホストOSのバックアップ方法に依存 |
| パフォーマンス | 最適化されている | ホストのファイルシステムに依存 |
| 使いやすさ | シンプル（Docker専用コマンドで操作） | 柔軟（既存のファイル操作が使える） |

## 4. 選択の指針

以下の場合はボリュームマウントを選択：
- 本番環境でのデプロイ
- Dockerのライフサイクルに合わせたデータ管理
- コンテナ間でのデータ共有
- クラウド環境など異なるホスト間での移行が必要な場合

以下の場合はバインドマウントを選択：
- 開発環境でのコード変更の即時反映
- 既存のホスト側ファイル構造との連携
- 特定のホスト側リソースへのアクセスが必要な場合
- ログやデータの直接的な監視や操作

## 5. よくある使用パターン

- データベースコンテナ → ボリュームマウント
- ウェブアプリケーション開発 → バインドマウント（開発時）、ボリュームマウント（本番時）
- ログ収集 → 状況により使い分け（監視が必要ならバインドマウント、単純な保存ならボリューム）
- 設定ファイル → バインドマウント（頻繁に変更する場合）、ボリュームマウント（管理された環境の場合）
