# .dockerignore の基本

## 概要
.dockerignore ファイルはDockerイメージ構築時に不要なファイルを除外し、ビルドプロセスを最適化するための重要な仕組みです。

## 主要概念
.dockerignore は .gitignore と同様のパターンマッチング構文を使用して、Docker ビルドコンテキストから特定のファイルやディレクトリを除外します。

## 基本的な使い方

### ファイル形式
- .dockerignore ファイルはプロジェクトのルートディレクトリ（Dockerfileと同じ場所）に配置します
- 1行に1つのパターンを記述します
- 各行はグロブパターンとして解釈されます

### 一般的な除外パターン例

```
# バージョン管理システム関連
.git
.gitignore
.svn

# ビルド成果物
node_modules
dist
build
*.o
*.obj
*.exe

# ログファイル
*.log
npm-debug.log*

# 環境変数ファイル
.env
.env.local
.env.development
.env.test
.env.production

# エディタ設定ファイル
.idea
.vscode
*.swp
*.swo

# OS関連ファイル
.DS_Store
Thumbs.db
```

### パターンマッチングのルール

1. **基本パターン**: ファイル名やディレクトリ名をそのまま記述
   ```
   node_modules
   package-lock.json
   ```

2. **ワイルドカード**:
   - `*`: 0文字以上の任意の文字列
   - `?`: 任意の1文字
   ```
   *.log    # 全ての.logファイル
   temp?    # temp + 任意の1文字（temp1, tempaなど）
   ```

3. **否定パターン**:
   - `!パターン`: 除外したくないファイルを指定
   ```
   *.md           # 全てのMarkdownファイルを除外
   !README.md     # ただしREADME.mdは除外しない
   ```

4. **ディレクトリ指定**:
   - `**/`: ディレクトリの階層を無視して一致
   - 末尾の `/`: ディレクトリのみに一致
   ```
   **/temp/       # 任意の階層のtempディレクトリ
   logs/          # logsディレクトリ
   ```

## .dockerignore を使うメリット

1. **ビルド時間の短縮**: 不要なファイルを除外することでビルドコンテキストが小さくなり、ビルド時間が短縮されます

2. **イメージサイズの最適化**: 実行時に不要なファイルがイメージに含まれないため、最終的なイメージサイズが小さくなります

3. **セキュリティリスク軽減**: 機密情報を含むファイル(.env など)を除外することで、イメージ内に機密情報が漏洩するリスクを軽減できます

## よくある間違い

1. Dockerfileと同じディレクトリに置かない
2. .gitignoreと混同する（構文は似ていますが別物です）
3. 必要なファイルまで除外してしまう
4. 否定パターン（!）の順序を間違える（否定パターンは、先に記述された除外パターンを上書きします）

## 実践的なヒント

- プロジェクト開始時に.dockerignoreを作成する習慣をつけましょう
- .gitignoreをベースにして、Docker特有の除外ファイルを追加すると効率的です
- ビルド前に `docker build -f Dockerfile .` コマンドの出力を確認し、意図しないファイルが含まれていないか確認しましょう
