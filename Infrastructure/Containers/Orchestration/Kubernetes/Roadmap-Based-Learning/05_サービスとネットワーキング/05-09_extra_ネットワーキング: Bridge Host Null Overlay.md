# Kubernetes ネットワーキング: Bridge / Host / Null / Overlay

## 概要
Kubernetesにおけるネットワーキングモデルは、コンテナ間の通信とクラスター内外の接続を実現する重要な基盤です。

## ネットワークモデルの理論
Kubernetesのネットワークモデルは、すべてのPodが固有のIPアドレスを持ち、NATなしで通信できる設計に基づいています。

## ネットワークモデルの種類

### 1. Bridge ネットワーク
- **基本概念**: ホスト上に仮想ブリッジを作成し、コンテナをこのブリッジに接続します
- **動作原理**: 
  - Dockerのデフォルトネットワークモード
  - ホスト上に`docker0`などの仮想ブリッジを作成
  - 各コンテナは仮想インターフェース（veth）を介してブリッジに接続
- **ユースケース**: 
  - 単一ホスト上での複数コンテナ間通信
  - 開発環境やシンプルな構成での利用
- **制限事項**:
  - 基本的に単一ホスト内での通信に最適化
  - ホスト間通信にはオーバーレイネットワークなどの追加機能が必要

### 2. Host ネットワーク
- **基本概念**: コンテナがホストのネットワーク名前空間を直接使用します
- **動作原理**:
  - コンテナがホストのネットワークスタックを共有
  - ポートの競合に注意が必要
  - 仮想インターフェースを作成せず、ネットワークオーバーヘッドを最小化
- **ユースケース**:
  - 高パフォーマンスが必要なアプリケーション
  - ネットワークパフォーマンスが重要な場面
  - ホストとの密接な統合が必要な場合
- **制限事項**:
  - ポートの競合リスク
  - 複数コンテナが同じポートを使用できない
  - ネットワーク分離が低下

### 3. Null (None) ネットワーク
- **基本概念**: コンテナにネットワークインターフェースを提供しません
- **動作原理**:
  - コンテナはループバックインターフェース以外のネットワークインターフェースを持たない
  - 外部との通信は不可能
- **ユースケース**:
  - データ処理のみを行うバッチジョブ
  - 外部ネットワーク接続を必要としないタスク
  - 完全に隔離された環境が必要な場合
- **制限事項**:
  - 外部通信不可
  - 他のコンテナとの通信不可

### 4. Overlay ネットワーク
- **基本概念**: 物理ネットワーク上に仮想ネットワークレイヤーを構築します
- **動作原理**:
  - VXLANなどのカプセル化技術を使用
  - ノード間の通信をカプセル化してルーティング
  - 複数のホストにまたがる仮想ネットワークを作成
- **ユースケース**:
  - 複数ホストにまたがるKubernetesクラスター
  - マルチノードでのコンテナオーケストレーション
  - クラウド環境でのマイクロサービスアーキテクチャ
- **実装例**:
  - Flannel
  - Calico
  - Weave
  - Cilium
- **制限事項**:
  - 軽微なパフォーマンスオーバーヘッド
  - 設定の複雑さ

## まとめ
Kubernetesでは、これらのネットワークモデルを用途に応じて選択することで、単一ホスト環境から大規模クラスターまで様々なユースケースに対応できます。初心者は主にBridgeネットワークから理解を始め、必要に応じてOverlayネットワークなどの高度なモデルへと進むことをお勧めします。
